<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Garantia - Real Car Amortecedores</title>
  <style>
    :root {
      --vermelho: #d62828;
      --cinza: #1e1e1e;
      --texto: #f8f9fa;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--cinza);
      color: var(--texto);
      padding: 20px;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background-color: #2a2a2a;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px #000;
    }
    .logo {
      display: block;
      margin: 0 auto 10px auto;
      max-width: 220px;
    }
    h1 {
      text-align: center;
      color: var(--vermelho);
      font-size: 22px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: var(--texto);
    }
    input[type="text"], input[type="date"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #555;
      font-size: 15px;
      background-color: #333;
      color: #f8f9fa;
    }
    .group {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 5px;
      font-weight: normal;
    }
    .extras {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    .extras input[type="text"] {
      height: 38px;
      padding: 8px;
      font-size: 15px;
      border-radius: 5px;
      border: 1px solid #555;
      background-color: #333;
      color: #f8f9fa;
    }
    .extras button {
      width: 40px;
      height: 38px;
      font-size: 18px;
      background: var(--vermelho);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    ul#listaExtras { margin-top: 10px; padding-left: 20px; }
    ul#listaExtras li { font-size: 14px; }
    button {
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      font-size: 16px;
      font-weight: bold;
      background-color: var(--vermelho);
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    /* ----- IMPRESS√ÉO ----- */
    @media print {
      body {
        background: white;
        color: black;
        font-family: Arial, sans-serif;
      }
      .container, button {
        display: none !important;
      }
      #printWrapper {
        display: block !important;
        text-align: center;
      }
      #printLogo {
        display: block !important;
        width: 220px;
        margin: 0 auto 10px auto;
      }
      #printArea {
        display: block !important;
        color: black !important;
        font-size: 15px;
        text-align: left;
        font-family: Arial, sans-serif;
        white-space: pre-wrap;
        padding: 10px 20px;
      }
    }
    #printWrapper { display: none; }
  </style>
</head>
<body>
  <div class="container">
    <img src="realcarsemfundo.jpg" alt="Logo Real Car" class="logo" />
    <h1>Garantia de Servi√ßo</h1>

    <label>Ve√≠culo:
      <input type="text" id="veiculo" placeholder="Ex: Corsa Sedan 1.6 2010">
    </label>

    <label>Placa:
      <input type="text" id="placa" placeholder="Ex: ABC1D23">
    </label>

    <label>Amortecedor Dianteiro:</label>
    <div class="group">
      <label><input type="checkbox" id="dianteiroDir"> Direito</label>
      <label><input type="checkbox" id="dianteiroEsq"> Esquerdo</label>
      <label><input type="checkbox" id="dianteiroPar"> Par</label>
    </div>

    <label>Amortecedor Traseiro:</label>
    <div class="group">
      <label><input type="checkbox" id="traseiroDir"> Direito</label>
      <label><input type="checkbox" id="traseiroEsq"> Esquerdo</label>
      <label><input type="checkbox" id="traseiroPar"> Par</label>
    </div>

    <label><input type="checkbox" id="amortecedorCentral"> Amortecedor Central</label>

    <label>Garantia:</label>
    <div class="group">
      <label><input type="checkbox" id="garantia3m"> 3 meses</label>
      <label><input type="checkbox" id="garantia6m"> 6 meses</label>
      <label><input type="checkbox" id="garantia1a"> 1 ano</label>
    </div>

    <label>Data de Venda:
      <input type="date" id="data">
    </label>

    <label>Valor Base:
      <input type="text" id="valorBase" placeholder="Ex: 600,00">
    </label>

    <label>Servi√ßos Extras:</label>
    <div class="extras">
      <input type="text" id="nomeExtra" placeholder="Servi√ßo" style="flex:2;">
      <input type="text" id="valorExtra" placeholder="Valor" style="flex:1;">
      <button type="button" id="btnAdd" onclick="addServicoExtra()">+</button>
    </div>
    <ul id="listaExtras"></ul>

    <label><b>Total:</b>
      <input type="text" id="totalCalculado" readonly>
    </label>

    <label>Telefone do Cliente (com DDD):
      <input type="text" id="telefoneCliente" placeholder="Ex: 83991234567">
    </label>

    <button onclick="imprimir()">üñ®Ô∏è Imprimir Garantia</button>
    <button onclick="enviarWhatsApp()">üì§ Enviar por WhatsApp</button>
  </div>

  <!-- √Årea da impress√£o -->
  <div id="printWrapper">
    <img id="printLogo" src="realcarsemfundo.jpg" alt="Logo Real Car (Impress√£o)">
    <div id="printArea"></div>
  </div>

  <script>
    let extras = [];

    window.onload = () => {
      const hoje = new Date().toLocaleDateString('fr-CA');
      document.getElementById("data").value = hoje;
      document.getElementById("valorBase").addEventListener("input", calcularTotal);

      const garantias = ["garantia3m", "garantia6m", "garantia1a"];
      garantias.forEach(id => {
        document.getElementById(id).addEventListener("change", e => {
          if (e.target.checked) {
            garantias.filter(g => g !== id).forEach(g => document.getElementById(g).checked = false);
          }
        });
      });
    };

    function formatar(valor) {
      const n = parseFloat(valor);
      if (isNaN(n)) return "0,00";
      return n.toFixed(2).replace('.', ',');
    }

    function addServicoExtra() {
      const nome = document.getElementById("nomeExtra").value.trim().toUpperCase();
      const valor = parseFloat(document.getElementById("valorExtra").value.replace(',', '.'));
      if (!nome || isNaN(valor)) return;
      extras.push({ nome, valor });
      document.getElementById("nomeExtra").value = "";
      document.getElementById("valorExtra").value = "";
      renderExtras();
      calcularTotal();
    }

    function renderExtras() {
      const lista = document.getElementById("listaExtras");
      lista.innerHTML = "";
      extras.forEach(e => {
        const li = document.createElement("li");
        li.textContent = `- ${e.nome} (R$ ${formatar(e.valor)})`;
        lista.appendChild(li);
      });
    }

    function calcularTotal() {
      const base = parseFloat(document.getElementById("valorBase").value.replace(',', '.')) || 0;
      const totalExtras = extras.reduce((s, e) => s + e.valor, 0);
      const total = base + totalExtras;
      document.getElementById("totalCalculado").value = total > 0 ? `R$ ${formatar(total)}` : "";
      return formatar(total);
    }

    function gerarTextoGarantia() {
      const veiculo = document.getElementById("veiculo").value.trim().toUpperCase();
      const placa = document.getElementById("placa").value.trim().toUpperCase();
      const data = document.getElementById("data").value || "-";
      const base = parseFloat(document.getElementById("valorBase").value.replace(',', '.')) || 0;
      const total = calcularTotal();

      const dianteiro = [];
      if (dianteiroDir.checked) dianteiro.push("Direito");
      if (dianteiroEsq.checked) dianteiro.push("Esquerdo");
      if (dianteiroPar.checked) dianteiro.push("Par");

      const traseiro = [];
      if (traseiroDir.checked) traseiro.push("Direito");
      if (traseiroEsq.checked) traseiro.push("Esquerdo");
      if (traseiroPar.checked) traseiro.push("Par");

      const central = document.getElementById("amortecedorCentral").checked ? "Sim" : null;

      let garantia = null;
      if (garantia3m.checked) garantia = "3 meses";
      if (garantia6m.checked) garantia = "6 meses";
      if (garantia1a.checked) garantia = "1 ano";

      let validade = "-";
      if (data !== "-" && garantia) {
        const d = new Date(data);
        if (garantia === "3 meses") d.setMonth(d.getMonth() + 3);
        if (garantia === "6 meses") d.setMonth(d.getMonth() + 6);
        if (garantia === "1 ano") d.setFullYear(d.getFullYear() + 1);
        validade = d.toLocaleDateString('pt-BR');
      }

      const agora = new Date();
      const dataHora = agora.toLocaleString('pt-BR', { dateStyle: 'short', timeStyle: 'short' });

      let texto = "";
      texto += "---------------------------------\n";
      texto += "Real Car Amortecedores\n";
      texto += "Recondicionamos amortecedores para carros nacionais e importados com garantia.\n";
      texto += "Rua Sargento Lauro Pereira da Silva, S/N - Box 15\n";
      texto += "Fone: (83) 99860-5077 - Jo√£o Pessoa - PB\n";
      texto += "---------------------------------\n\n";

      if (veiculo) texto += `Ve√≠culo: ${veiculo}\n`;
      if (placa) texto += `Placa: ${placa}\n`;
      if (dianteiro.length) texto += `Amortecedor Dianteiro: ${dianteiro.join(", ")}\n`;
      if (traseiro.length) texto += `Amortecedor Traseiro: ${traseiro.join(", ")}\n`;
      if (central) texto += `Amortecedor Central: ${central}\n`;
      if (garantia) texto += `Garantia: ${garantia}\n`;
      texto += `Data da Venda: ${data}\n`;
      texto += `Validade at√©: ${validade}\n`;
      if (base > 0) texto += `Valor Base: R$ ${formatar(base)}\n`;

      if (extras.length) {
        texto += "Servi√ßos Extras:\n";
        extras.forEach(e => texto += `- ${e.nome} (R$ ${formatar(e.valor)})\n`);
      }

      texto += `Total: R$ ${total}\n\n`;
      texto += "Assinatura: ___________________________\n\n";
      texto += `Emitido em: ${dataHora}\n`;

      return texto;
    }

    function imprimir() {
      document.getElementById("printArea").innerText = gerarTextoGarantia();
      setTimeout(() => window.print(), 100);
    }

    function enviarWhatsApp() {
      let numero = document.getElementById("telefoneCliente").value.trim();
      if (!numero) {
        alert("Informe o n√∫mero do cliente com DDD (ex: 83991234567).");
        return;
      }
      numero = numero.replace(/\D/g, "");
      if (numero.length < 10) {
        alert("N√∫mero inv√°lido. Use DDD + n√∫mero.");
        return;
      }
      const mensagem = encodeURIComponent(
        "Ol√°! Aqui √© da Real Car Amortecedores.\n\nSegue abaixo a garantia referente ao servi√ßo realizado no seu ve√≠culo.\n\nReal Car Amortecedores\nDistrito Mec√¢nico - Box 15\nJo√£o Pessoa - PB\n(83) 99860-5077\n\nQualquer d√∫vida, estamos √† disposi√ß√£o!"
      );
      const url = `https://wa.me/55${numero}?text=${mensagem}`;
      window.open(url, "_blank");
    }
  </script>
</body>
</html>
